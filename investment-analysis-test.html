<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŠ•è³‡åˆ†ææ¸¬è©¦</title>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }
        input, textarea, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }
        button {
            background: #4a90e2;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        button:hover {
            background: #357abd;
        }
        .result {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
            border-left: 4px solid #4a90e2;
        }
        .metric {
            background: #e3f2fd;
            padding: 10px;
            border-radius: 4px;
            margin: 5px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .insight {
            background: #fff3e0;
            padding: 10px;
            border-radius: 4px;
            margin: 5px 0;
            border-left: 3px solid #ff9800;
        }
        .recommendation {
            background: #e8f5e8;
            padding: 10px;
            border-radius: 4px;
            margin: 5px 0;
            border-left: 3px solid #4caf50;
        }
        .risk-low { color: #4caf50; font-weight: bold; }
        .risk-medium { color: #ff9800; font-weight: bold; }
        .risk-high { color: #f44336; font-weight: bold; }
        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 5px 0;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4caf50, #8bc34a);
            transition: width 0.3s ease;
        }
        .goal-card {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }
        .sample-holding {
            background: #f5f5f5;
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
            font-size: 12px;
        }
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .score-circle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            font-size: 14px;
        }
        .score-high { background: #4caf50; }
        .score-medium { background: #ff9800; }
        .score-low { background: #f44336; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“ˆ æŠ•è³‡åˆ†æåŠŸèƒ½æ¸¬è©¦</h1>
        
        <!-- æŠ•è³‡çµ„åˆåˆ†ææ¸¬è©¦ -->
        <div class="section">
            <h2>ğŸ“Š æŠ•è³‡çµ„åˆåˆ†ææ¸¬è©¦</h2>
            
            <div class="two-column">
                <div>
                    <h3>æ¸¬è©¦è³‡æ–™</h3>
                    <div id="sampleHoldings">
                        <div class="sample-holding">
                            <strong>å°ç©é›» (2330)</strong> - 10è‚¡ @ $550 - ç§‘æŠ€è‚¡
                        </div>
                        <div class="sample-holding">
                            <strong>è¯ç™¼ç§‘ (2454)</strong> - 5è‚¡ @ $800 - ç§‘æŠ€è‚¡
                        </div>
                        <div class="sample-holding">
                            <strong>å°æ–°é‡‘ (2882)</strong> - 20è‚¡ @ $15 - é‡‘èè‚¡
                        </div>
                        <div class="sample-holding">
                            <strong>ä¸­é‹¼ (2002)</strong> - 15è‚¡ @ $35 - å‚³ç”¢è‚¡
                        </div>
                        <div class="sample-holding">
                            <strong>å°ç£50 (0050)</strong> - 100è‚¡ @ $150 - ETF
                        </div>
                    </div>
                    
                    <button onclick="testPortfolioAnalysis()">åˆ†ææŠ•è³‡çµ„åˆ</button>
                    <button onclick="generateMoreHoldings()">ç”Ÿæˆæ›´å¤šæ¸¬è©¦è³‡æ–™</button>
                    <button onclick="addCustomHolding()">æ–°å¢è‡ªè¨‚æŒè‚¡</button>
                </div>
                
                <div>
                    <h3>è‡ªè¨‚æŒè‚¡</h3>
                    <div class="form-group">
                        <label for="stockName">è‚¡ç¥¨åç¨±</label>
                        <input type="text" id="stockName" placeholder="ä¾‹å¦‚: å°ç©é›»">
                    </div>
                    <div class="form-group">
                        <label for="stockSymbol">è‚¡ç¥¨ä»£ç¢¼</label>
                        <input type="text" id="stockSymbol" placeholder="ä¾‹å¦‚: 2330">
                    </div>
                    <div class="form-group">
                        <label for="stockQuantity">æŒè‚¡æ•¸é‡</label>
                        <input type="number" id="stockQuantity" placeholder="ä¾‹å¦‚: 10">
                    </div>
                    <div class="form-group">
                        <label for="stockPrice">ç•¶å‰åƒ¹æ ¼</label>
                        <input type="number" id="stockPrice" placeholder="ä¾‹å¦‚: 550">
                    </div>
                    <div class="form-group">
                        <label for="stockCost">æˆæœ¬åƒ¹æ ¼</label>
                        <input type="number" id="stockCost" placeholder="ä¾‹å¦‚: 500">
                    </div>
                </div>
            </div>
            
            <div id="portfolioResult" class="result" style="display: none;"></div>
        </div>
        
        <!-- æŠ•è³‡ç›®æ¨™è¿½è¹¤æ¸¬è©¦ -->
        <div class="section">
            <h2>ğŸ¯ æŠ•è³‡ç›®æ¨™è¿½è¹¤æ¸¬è©¦</h2>
            
            <div class="two-column">
                <div>
                    <h3>æ¸¬è©¦ç›®æ¨™</h3>
                    <div id="sampleGoals">
                        <div class="goal-card">
                            <strong>é€€ä¼‘åŸºé‡‘</strong><br>
                            ç›®æ¨™: NT$10,000,000<br>
                            æœŸé™: 2045å¹´<br>
                            ç‹€æ…‹: é€²è¡Œä¸­
                        </div>
                        <div class="goal-card">
                            <strong>æ•™è‚²åŸºé‡‘</strong><br>
                            ç›®æ¨™: NT$2,000,000<br>
                            æœŸé™: 2030å¹´<br>
                            ç‹€æ…‹: é€²è¡Œä¸­
                        </div>
                        <div class="goal-card">
                            <strong>è³¼å±‹åŸºé‡‘</strong><br>
                            ç›®æ¨™: NT$5,000,000<br>
                            æœŸé™: 2028å¹´<br>
                            ç‹€æ…‹: é€²è¡Œä¸­
                        </div>
                    </div>
                    
                    <button onclick="testGoalTracking()">è¿½è¹¤æŠ•è³‡ç›®æ¨™</button>
                    <button onclick="addCustomGoal()">æ–°å¢è‡ªè¨‚ç›®æ¨™</button>
                </div>
                
                <div>
                    <h3>è‡ªè¨‚ç›®æ¨™</h3>
                    <div class="form-group">
                        <label for="goalName">ç›®æ¨™åç¨±</label>
                        <input type="text" id="goalName" placeholder="ä¾‹å¦‚: é€€ä¼‘åŸºé‡‘">
                    </div>
                    <div class="form-group">
                        <label for="goalType">ç›®æ¨™é¡å‹</label>
                        <select id="goalType">
                            <option value="retirement">é€€ä¼‘åŸºé‡‘</option>
                            <option value="education">æ•™è‚²åŸºé‡‘</option>
                            <option value="house">è³¼å±‹åŸºé‡‘</option>
                            <option value="general">ä¸€èˆ¬ç›®æ¨™</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="goalAmount">ç›®æ¨™é‡‘é¡</label>
                        <input type="number" id="goalAmount" placeholder="ä¾‹å¦‚: 10000000">
                    </div>
                    <div class="form-group">
                        <label for="goalDate">ç›®æ¨™æ—¥æœŸ</label>
                        <input type="date" id="goalDate">
                    </div>
                </div>
            </div>
            
            <div id="goalResult" class="result" style="display: none;"></div>
        </div>
        
        <!-- å¿«é€Ÿæ¸¬è©¦ -->
        <div class="section">
            <h2>âš¡ å¿«é€Ÿæ¸¬è©¦</h2>
            <button onclick="quickTest('conservative')">ä¿å®ˆå‹æŠ•è³‡çµ„åˆ</button>
            <button onclick="quickTest('balanced')">å¹³è¡¡å‹æŠ•è³‡çµ„åˆ</button>
            <button onclick="quickTest('aggressive')">ç©æ¥µå‹æŠ•è³‡çµ„åˆ</button>
            <button onclick="quickTest('retirement')">é€€ä¼‘ç›®æ¨™æ¸¬è©¦</button>
            <button onclick="quickTest('house')">è³¼å±‹ç›®æ¨™æ¸¬è©¦</button>
        </div>
    </div>

    <!-- è¼‰å…¥æŠ•è³‡åˆ†ææ¨¡çµ„ -->
    <script src="js/investment-analysis.js"></script>
    
    <script>
        // æ¸¬è©¦è³‡æ–™
        let testHoldings = [
            { symbol: '2330', name: 'å°ç©é›»', quantity: 10, currentPrice: 550, avgCost: 500, type: 'stock' },
            { symbol: '2454', name: 'è¯ç™¼ç§‘', quantity: 5, currentPrice: 800, avgCost: 750, type: 'stock' },
            { symbol: '2882', name: 'å°æ–°é‡‘', quantity: 20, currentPrice: 15, avgCost: 12, type: 'stock' },
            { symbol: '2002', name: 'ä¸­é‹¼', quantity: 15, currentPrice: 35, avgCost: 30, type: 'stock' },
            { symbol: '0050', name: 'å°ç£50', quantity: 100, currentPrice: 150, avgCost: 140, type: 'etf' }
        ];
        
        let testGoals = [
            {
                id: 'retirement',
                name: 'é€€ä¼‘åŸºé‡‘',
                type: 'retirement',
                targetAmount: 10000000,
                targetDate: '2045-01-01',
                duration: 240
            },
            {
                id: 'education',
                name: 'æ•™è‚²åŸºé‡‘',
                type: 'education',
                targetAmount: 2000000,
                targetDate: '2030-01-01',
                duration: 72
            },
            {
                id: 'house',
                name: 'è³¼å±‹åŸºé‡‘',
                type: 'house',
                targetAmount: 5000000,
                targetDate: '2028-01-01',
                duration: 48
            }
        ];
        
        // æ¸¬è©¦æŠ•è³‡çµ„åˆåˆ†æ
        function testPortfolioAnalysis() {
            const analysis = InvestmentAnalysis.analyzePortfolio(testHoldings);
            const resultDiv = document.getElementById('portfolioResult');
            
            if (analysis) {
                let html = `
                    <h3>ğŸ“Š æŠ•è³‡çµ„åˆåˆ†æçµæœ</h3>
                    
                    <h4>ğŸ’° æŠ•è³‡çµ„åˆæ¦‚æ³</h4>
                    <div class="metric">
                        <span>ç¸½å¸‚å€¼:</span>
                        <strong>NT$${analysis.summary.totalValue.toLocaleString()}</strong>
                    </div>
                    <div class="metric">
                        <span>ç¸½æˆæœ¬:</span>
                        <strong>NT$${analysis.summary.totalCost.toLocaleString()}</strong>
                    </div>
                    <div class="metric">
                        <span>ç¸½æç›Š:</span>
                        <strong style="color: ${analysis.summary.totalGain >= 0 ? '#4caf50' : '#f44336'}">
                            NT$${analysis.summary.totalGain.toLocaleString()} (${analysis.summary.totalGainPercent.toFixed(1)}%)
                        </strong>
                    </div>
                    <div class="metric">
                        <span>æŒè‚¡æ•¸é‡:</span>
                        <strong>${analysis.summary.holdingsCount}</strong>
                    </div>
                    
                    <h4>âš ï¸ é¢¨éšªè©•ä¼°</h4>
                    <div class="metric">
                        <span>é¢¨éšªè©•åˆ†:</span>
                        <div class="score-circle score-${analysis.risk.riskLevel}">${analysis.risk.riskScore}</div>
                    </div>
                    <div class="metric">
                        <span>é¢¨éšªç­‰ç´š:</span>
                        <strong class="risk-${analysis.risk.riskLevel}">${getRiskLevelText(analysis.risk.riskLevel)}</strong>
                    </div>
                    <div class="metric">
                        <span>é›†ä¸­åº¦é¢¨éšª:</span>
                        <strong>${(analysis.risk.concentrationRisk * 100).toFixed(1)}%</strong>
                    </div>
                    <div class="metric">
                        <span>æ³¢å‹•ç‡é¢¨éšª:</span>
                        <strong>${(analysis.risk.volatilityRisk * 100).toFixed(1)}%</strong>
                    </div>
                    
                    <h4>ğŸŒ åˆ†æ•£åº¦åˆ†æ</h4>
                    <div class="metric">
                        <span>åˆ†æ•£åº¦åˆ†æ•¸:</span>
                        <div class="score-circle score-${getScoreLevel(analysis.diversification.diversificationScore)}">${analysis.diversification.diversificationScore}</div>
                    </div>
                `;
                
                // ç”¢æ¥­åˆ†é…
                html += '<h5>ç”¢æ¥­åˆ†é…:</h5>';
                Object.entries(analysis.diversification.sectorAllocation).forEach(([sector, value]) => {
                    const percentage = (value / analysis.summary.totalValue * 100).toFixed(1);
                    html += `
                        <div class="metric">
                            <span>${sector}:</span>
                            <strong>${percentage}%</strong>
                        </div>
                    `;
                });
                
                // åœ°åŸŸåˆ†é…
                html += '<h5>åœ°åŸŸåˆ†é…:</h5>';
                Object.entries(analysis.diversification.geographicAllocation).forEach(([region, value]) => {
                    const percentage = (value / analysis.summary.totalValue * 100).toFixed(1);
                    html += `
                        <div class="metric">
                            <span>${region}:</span>
                            <strong>${percentage}%</strong>
                        </div>
                    `;
                });
                
                // ç¸¾æ•ˆåˆ†æ
                html += `
                    <h4>ğŸ“ˆ ç¸¾æ•ˆåˆ†æ</h4>
                    <div class="metric">
                        <span>æœ€ä½³è¡¨ç¾:</span>
                        <strong>${analysis.performance.bestPerformer.name} (${analysis.performance.bestPerformer.return.toFixed(1)}%)</strong>
                    </div>
                    <div class="metric">
                        <span>æœ€å·®è¡¨ç¾:</span>
                        <strong>${analysis.performance.worstPerformer.name} (${analysis.performance.worstPerformer.return.toFixed(1)}%)</strong>
                    </div>
                    <div class="metric">
                        <span>å¹³å‡å ±é…¬ç‡:</span>
                        <strong>${analysis.performance.averageReturn.toFixed(1)}%</strong>
                    </div>
                    <div class="metric">
                        <span>å¤æ™®æ¯”ç‡:</span>
                        <strong>${analysis.performance.sharpeRatio.toFixed(2)}</strong>
                    </div>
                `;
                
                // æ´å¯Ÿ
                html += '<h4>ğŸ’¡ æŠ•è³‡æ´å¯Ÿ</h4>';
                analysis.insights.forEach(insight => {
                    html += `
                        <div class="insight">
                            <strong>${insight.title}:</strong> ${insight.content}
                        </div>
                    `;
                });
                
                // å»ºè­°
                html += '<h4>ğŸ¯ æ”¹å–„å»ºè­°</h4>';
                analysis.recommendations.forEach(rec => {
                    html += `
                        <div class="recommendation">
                            <strong>${rec.title}:</strong> ${rec.content}
                        </div>
                    `;
                });
                
                resultDiv.innerHTML = html;
            } else {
                resultDiv.innerHTML = '<div class="result">ç„¡æ³•é€²è¡Œåˆ†æï¼Œè«‹æª¢æŸ¥è³‡æ–™æ ¼å¼</div>';
            }
            
            resultDiv.style.display = 'block';
        }
        
        // æ¸¬è©¦ç›®æ¨™è¿½è¹¤
        function testGoalTracking() {
            const currentPortfolio = InvestmentAnalysis.analyzePortfolio(testHoldings) || { summary: { totalValue: 100000 } };
            const tracking = InvestmentAnalysis.trackInvestmentGoals(testGoals, currentPortfolio);
            const resultDiv = document.getElementById('goalResult');
            
            if (tracking) {
                let html = `
                    <h3>ğŸ¯ æŠ•è³‡ç›®æ¨™è¿½è¹¤çµæœ</h3>
                    
                    <h4>ğŸ“Š ç›®æ¨™æ¦‚æ³</h4>
                    <div class="metric">
                        <span>ç¸½ç›®æ¨™æ•¸:</span>
                        <strong>${tracking.overview.totalGoals}</strong>
                    </div>
                    <div class="metric">
                        <span>å·²å®Œæˆ:</span>
                        <strong>${tracking.overview.completedGoals}</strong>
                    </div>
                    <div class="metric">
                        <span>é€²è¡Œä¸­:</span>
                        <strong>${tracking.overview.inProgressGoals}</strong>
                    </div>
                    <div class="metric">
                        <span>æœªé–‹å§‹:</span>
                        <strong>${tracking.overview.notStartedGoals}</strong>
                    </div>
                    <div class="metric">
                        <span>ç¸½ç›®æ¨™é‡‘é¡:</span>
                        <strong>NT$${tracking.overview.totalTargetAmount.toLocaleString()}</strong>
                    </div>
                    <div class="metric">
                        <span>ç•¶å‰é€²åº¦:</span>
                        <strong>NT$${tracking.overview.totalCurrentAmount.toLocaleString()} (${Math.round(tracking.overview.totalCurrentAmount / tracking.overview.totalTargetAmount * 100)}%)</strong>
                    </div>
                    
                    <h4>ğŸ¯ å€‹åˆ¥ç›®æ¨™é€²åº¦</h4>
                `;
                
                tracking.goals.forEach(goal => {
                    const statusColor = goal.status === 'completed' ? '#4caf50' : 
                                       goal.status === 'in_progress' ? '#ff9800' : '#f44336';
                    
                    html += `
                        <div class="goal-card">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <strong>${goal.name}</strong><br>
                                    <span style="color: ${statusColor};">ç‹€æ…‹: ${getStatusText(goal.status)}</span>
                                </div>
                                <div class="score-circle score-${getScoreLevel(goal.progress)}">${goal.progress}%</div>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${goal.progress}%"></div>
                            </div>
                            <div style="font-size: 12px; margin-top: 5px;">
                                ç›®æ¨™: NT$${goal.targetAmount.toLocaleString()} | 
                                ç•¶å‰: NT$${goal.currentAmount.toLocaleString()} | 
                                å‰©é¤˜: ${goal.timeRemaining}å€‹æœˆ | 
                                æœˆéœ€: NT$${goal.monthlyRequired.toLocaleString()}
                            </div>
                        </div>
                    `;
                });
                
                // æ´å¯Ÿ
                html += '<h4>ğŸ’¡ ç›®æ¨™æ´å¯Ÿ</h4>';
                tracking.insights.forEach(insight => {
                    html += `
                        <div class="insight">
                            <strong>${insight.title}:</strong> ${insight.content}
                        </div>
                    `;
                });
                
                // å»ºè­°
                html += '<h4>ğŸ¯ æ”¹å–„å»ºè­°</h4>';
                tracking.recommendations.forEach(rec => {
                    html += `
                        <div class="recommendation">
                            <strong>${rec.title}:</strong> ${rec.content}
                        </div>
                    `;
                });
                
                resultDiv.innerHTML = html;
            } else {
                resultDiv.innerHTML = '<div class="result">ç„¡æ³•é€²è¡Œè¿½è¹¤ï¼Œè«‹æª¢æŸ¥è³‡æ–™æ ¼å¼</div>';
            }
            
            resultDiv.style.display = 'block';
        }
        
        // ç”Ÿæˆæ›´å¤šæ¸¬è©¦æŒè‚¡
        function generateMoreHoldings() {
            const stocks = [
                { symbol: '2308', name: 'å°é”é›»', sector: 'é›»å­', price: 250 },
                { symbol: '2317', name: 'é´»æµ·', sector: 'é›»å­', price: 120 },
                { symbol: '1301', name: 'å°å¡‘', sector: 'å‚³ç”¢', price: 80 },
                { symbol: '1303', name: 'å—äº', sector: 'å‚³ç”¢', price: 70 },
                { symbol: '2881', name: 'å¯Œé‚¦é‡‘', sector: 'é‡‘è', price: 45 },
                { symbol: '2884', name: 'ç‰å±±é‡‘', sector: 'é‡‘è', price: 20 },
                { symbol: '4155', name: 'è—¥è¯', sector: 'ç”ŸæŠ€', price: 180 },
                { symbol: '6532', name: 'å°æ–°åŒ»', sector: 'ç”ŸæŠ€', price: 90 }
            ];
            
            for (let i = 0; i < 5; i++) {
                const stock = stocks[Math.floor(Math.random() * stocks.length)];
                const quantity = Math.floor(Math.random() * 50) + 1;
                const costBase = stock.price * (0.8 + Math.random() * 0.4);
                
                testHoldings.push({
                    symbol: stock.symbol,
                    name: stock.name,
                    quantity: quantity,
                    currentPrice: stock.price,
                    avgCost: costBase,
                    type: 'stock'
                });
            }
            
            updateHoldingsDisplay();
            alert('å·²ç”Ÿæˆ5ç­†æ¸¬è©¦æŒè‚¡ï¼Œç¸½å…±' + testHoldings.length + 'ç­†');
        }
        
        // æ–°å¢è‡ªè¨‚æŒè‚¡
        function addCustomHolding() {
            const name = document.getElementById('stockName').value;
            const symbol = document.getElementById('stockSymbol').value;
            const quantity = parseInt(document.getElementById('stockQuantity').value);
            const price = parseFloat(document.getElementById('stockPrice').value);
            const cost = parseFloat(document.getElementById('stockCost').value);
            
            if (!name || !symbol || !quantity || !price || !cost) {
                alert('è«‹å¡«å¯«å®Œæ•´çš„æŒè‚¡è³‡è¨Š');
                return;
            }
            
            testHoldings.push({
                symbol: symbol,
                name: name,
                quantity: quantity,
                currentPrice: price,
                avgCost: cost,
                type: 'stock'
            });
            
            updateHoldingsDisplay();
            
            // æ¸…ç©ºè¡¨å–®
            document.getElementById('stockName').value = '';
            document.getElementById('stockSymbol').value = '';
            document.getElementById('stockQuantity').value = '';
            document.getElementById('stockPrice').value = '';
            document.getElementById('stockCost').value = '';
            
            alert('å·²æ–°å¢æŒè‚¡');
        }
        
        // æ–°å¢è‡ªè¨‚ç›®æ¨™
        function addCustomGoal() {
            const name = document.getElementById('goalName').value;
            const type = document.getElementById('goalType').value;
            const amount = parseFloat(document.getElementById('goalAmount').value);
            const date = document.getElementById('goalDate').value;
            
            if (!name || !amount || !date) {
                alert('è«‹å¡«å¯«å®Œæ•´çš„ç›®æ¨™è³‡è¨Š');
                return;
            }
            
            const targetDate = new Date(date);
            const now = new Date();
            const duration = Math.floor((targetDate - now) / (1000 * 60 * 60 * 24 * 30));
            
            testGoals.push({
                id: 'custom_' + Date.now(),
                name: name,
                type: type,
                targetAmount: amount,
                targetDate: date,
                duration: duration
            });
            
            updateGoalsDisplay();
            
            // æ¸…ç©ºè¡¨å–®
            document.getElementById('goalName').value = '';
            document.getElementById('goalAmount').value = '';
            document.getElementById('goalDate').value = '';
            
            alert('å·²æ–°å¢ç›®æ¨™');
        }
        
        // å¿«é€Ÿæ¸¬è©¦
        function quickTest(type) {
            const testCases = {
                conservative: {
                    holdings: [
                        { symbol: '0056', name: 'é«˜è‚¡æ¯ETF', quantity: 100, currentPrice: 30, avgCost: 28, type: 'etf' },
                        { symbol: '2884', name: 'ç‰å±±é‡‘', quantity: 50, currentPrice: 20, avgCost: 18, type: 'stock' },
                        { symbol: '1301', name: 'å°å¡‘', quantity: 30, currentPrice: 80, avgCost: 75, type: 'stock' }
                    ],
                    description: 'ä¿å®ˆå‹æŠ•è³‡çµ„åˆ'
                },
                balanced: {
                    holdings: [
                        { symbol: '0050', name: 'å°ç£50', quantity: 100, currentPrice: 150, avgCost: 140, type: 'etf' },
                        { symbol: '2330', name: 'å°ç©é›»', quantity: 5, currentPrice: 550, avgCost: 500, type: 'stock' },
                        { symbol: '2882', name: 'å°æ–°é‡‘', quantity: 20, currentPrice: 15, avgCost: 12, type: 'stock' },
                        { symbol: '2308', name: 'å°é”é›»', quantity: 10, currentPrice: 250, avgCost: 230, type: 'stock' }
                    ],
                    description: 'å¹³è¡¡å‹æŠ•è³‡çµ„åˆ'
                },
                aggressive: {
                    holdings: [
                        { symbol: '2330', name: 'å°ç©é›»', quantity: 20, currentPrice: 550, avgCost: 500, type: 'stock' },
                        { symbol: '2454', name: 'è¯ç™¼ç§‘', quantity: 10, currentPrice: 800, avgCost: 750, type: 'stock' },
                        { symbol: '4155', name: 'è—¥è¯', quantity: 15, currentPrice: 180, avgCost: 150, type: 'stock' }
                    ],
                    description: 'ç©æ¥µå‹æŠ•è³‡çµ„åˆ'
                },
                retirement: {
                    goals: [{
                        id: 'retirement_test',
                        name: 'é€€ä¼‘åŸºé‡‘æ¸¬è©¦',
                        type: 'retirement',
                        targetAmount: 20000000,
                        targetDate: '2040-01-01',
                        duration: 192
                    }],
                    description: 'é€€ä¼‘ç›®æ¨™æ¸¬è©¦'
                },
                house: {
                    goals: [{
                        id: 'house_test',
                        name: 'è³¼å±‹åŸºé‡‘æ¸¬è©¦',
                        type: 'house',
                        targetAmount: 8000000,
                        targetDate: '2030-01-01',
                        duration: 72
                    }],
                    description: 'è³¼å±‹ç›®æ¨™æ¸¬è©¦'
                }
            };
            
            const testCase = testCases[type];
            
            if (testCase.holdings) {
                testHoldings = testCase.holdings;
                updateHoldingsDisplay();
                testPortfolioAnalysis();
            } else if (testCase.goals) {
                testGoals = testCase.goals;
                updateGoalsDisplay();
                testGoalTracking();
            }
            
            alert(`å·²è¼‰å…¥${testCase.description}æ¸¬è©¦è³‡æ–™`);
        }
        
        // æ›´æ–°é¡¯ç¤º
        function updateHoldingsDisplay() {
            const container = document.getElementById('sampleHoldings');
            container.innerHTML = testHoldings.slice(-10).map(holding => `
                <div class="sample-holding">
                    <strong>${holding.name} (${holding.symbol})</strong> - ${holding.quantity}è‚¡ @ $${holding.currentPrice} - ${getStockTypeText(holding)}
                </div>
            `).join('');
        }
        
        function updateGoalsDisplay() {
            const container = document.getElementById('sampleGoals');
            container.innerHTML = testGoals.map(goal => {
                const targetDate = new Date(goal.targetDate);
                const now = new Date();
                const remaining = Math.floor((targetDate - now) / (1000 * 60 * 60 * 24 * 30));
                
                return `
                    <div class="goal-card">
                        <strong>${goal.name}</strong><br>
                        ç›®æ¨™: NT$${goal.targetAmount.toLocaleString()}<br>
                        æœŸé™: ${goal.targetDate}<br>
                        å‰©é¤˜: ${remaining}å€‹æœˆ
                    </div>
                `;
            }).join('');
        }
        
        // è¼”åŠ©å‡½æ•¸
        function getRiskLevelText(level) {
            const texts = {
                'low': 'ä½é¢¨éšª',
                'medium': 'ä¸­ç­‰é¢¨éšª',
                'high': 'é«˜é¢¨éšª'
            };
            return texts[level] || level;
        }
        
        function getScoreLevel(score) {
            if (score >= 70) return 'high';
            if (score >= 40) return 'medium';
            return 'low';
        }
        
        function getStatusText(status) {
            const texts = {
                'completed': 'å·²å®Œæˆ',
                'in_progress': 'é€²è¡Œä¸­',
                'not_started': 'æœªé–‹å§‹'
            };
            return texts[status] || status;
        }
        
        function getStockTypeText(holding) {
            if (holding.type === 'etf') return 'ETF';
            if (holding.name.includes('é›»') || holding.name.includes('åŠå°é«”')) return 'ç§‘æŠ€è‚¡';
            if (holding.name.includes('é‡‘') || holding.name.includes('éŠ€')) return 'é‡‘èè‚¡';
            if (holding.name.includes('å¡‘') || holding.name.includes('é‹¼')) return 'å‚³ç”¢è‚¡';
            if (holding.name.includes('è—¥') || holding.name.includes('é†«')) return 'ç”ŸæŠ€è‚¡';
            return 'è‚¡ç¥¨';
        }
        
        // é é¢è¼‰å…¥å®Œæˆ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('æŠ•è³‡åˆ†ææ¸¬è©¦é é¢å·²è¼‰å…¥');
            console.log('å¯ç”¨åŠŸèƒ½:', Object.keys(window.InvestmentAnalysis));
        });
    </script>
</body>
</html>
