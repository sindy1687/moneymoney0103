<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸»é¡Œç³»çµ±æ¸¬è©¦</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-button {
            background: #4a90e2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #357abd;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            background: #e8f5e8;
            border: 1px solid #c8e6c9;
        }
        .error {
            background: #ffebee;
            border-color: #ffcdd2;
            color: #c62828;
        }
        .success {
            background: #e8f5e8;
            border-color: #c8e6c9;
            color: #2e7d32;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ¨ ä¸»é¡Œç³»çµ±æ¨¡çµ„åŒ–æ¸¬è©¦</h1>
        
        <div class="status" id="status">
            æ­£åœ¨è¼‰å…¥ä¸»é¡Œæ¨¡çµ„...
        </div>

        <h2>ğŸ“‹ æ¨¡çµ„è¼‰å…¥ç‹€æ…‹</h2>
        <div id="module-status">
            <p>æª¢æŸ¥æ¨¡çµ„è¼‰å…¥ç‹€æ…‹...</p>
        </div>

        <h2>ğŸ§ª åŠŸèƒ½æ¸¬è©¦</h2>
        <button class="test-button" onclick="testThemeData()">æ¸¬è©¦ä¸»é¡Œæ•¸æ“š</button>
        <button class="test-button" onclick="testThemeIcons()">æ¸¬è©¦åœ–æ¨™é…ç½®</button>
        <button class="test-button" onclick="testThemeCore()">æ¸¬è©¦æ ¸å¿ƒåŠŸèƒ½</button>
        <button class="test-button" onclick="testThemeUI()">æ¸¬è©¦UIçµ„ä»¶</button>
        <button class="test-button" onclick="applyTestTheme()">æ‡‰ç”¨æ¸¬è©¦ä¸»é¡Œ</button>
        <button class="test-button" onclick="showThemeSelector()">é¡¯ç¤ºä¸»é¡Œé¸æ“‡å™¨</button>

        <h2>ğŸ“Š æ¸¬è©¦çµæœ</h2>
        <div id="test-results">
            <p>é»æ“Šä¸Šæ–¹æŒ‰éˆ•é€²è¡Œæ¸¬è©¦...</p>
        </div>
    </div>

    <!-- è¼‰å…¥ä¸»é¡Œç³»çµ± -->
    <script src="js/theme.js"></script>

    <script>
        // æ¸¬è©¦å‡½æ•¸
        function updateStatus(message, isError = false) {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = isError ? 'status error' : 'status success';
        }

        function addTestResult(test, result, details = '') {
            const results = document.getElementById('test-results');
            const div = document.createElement('div');
            div.style.cssText = 'padding: 10px; margin: 5px 0; border-radius: 5px; background: ' + 
                              (result ? '#e8f5e8' : '#ffebee') + '; border: 1px solid ' + 
                              (result ? '#c8e6c9' : '#ffcdd2') + ';';
            div.innerHTML = `<strong>${test}:</strong> ${result ? 'âœ… é€šé' : 'âŒ å¤±æ•—'} ${details}`;
            results.appendChild(div);
        }

        function checkModuleStatus() {
            const modules = [
                { name: 'ThemeData', window: 'ThemeData' },
                { name: 'ThemeIcons', window: 'ThemeIcons' },
                { name: 'ThemeCore', window: 'ThemeCore' },
                { name: 'ThemeUI', window: 'ThemeUI' }
            ];

            const statusDiv = document.getElementById('module-status');
            let html = '';

            modules.forEach(module => {
                const loaded = window[module.window] !== undefined;
                html += `<p style="color: ${loaded ? 'green' : 'red'};">
                    ${loaded ? 'âœ…' : 'âŒ'} ${module.name}: ${loaded ? 'å·²è¼‰å…¥' : 'æœªè¼‰å…¥'}
                </p>`;
            });

            statusDiv.innerHTML = html;
        }

        function testThemeData() {
            try {
                const themes = window.ThemeData ? window.ThemeData.themes : [];
                const categories = window.ThemeData ? window.ThemeData.themeCategories : {};
                
                const result = themes.length > 0 && Object.keys(categories).length > 0;
                addTestResult('ä¸»é¡Œæ•¸æ“šæ¨¡çµ„', result, 
                    `ä¸»é¡Œæ•¸é‡: ${themes.length}, åˆ†é¡æ•¸é‡: ${Object.keys(categories).length}`);
                
                if (result && themes.length > 0) {
                    addTestResult('å¤¢å¹»è—å¤œä¸»é¡Œå­˜åœ¨', 
                        themes.some(t => t.id === 'dreamyBlue'), 
                        'æª¢æŸ¥æ–°æ·»åŠ çš„ä¸»é¡Œ');
                }
            } catch (error) {
                addTestResult('ä¸»é¡Œæ•¸æ“šæ¨¡çµ„', false, error.message);
            }
        }

        function testThemeIcons() {
            try {
                const icons = window.ThemeIcons ? window.ThemeIcons.buttonIcons : {};
                const original = window.ThemeIcons ? window.ThemeIcons.originalButtonIcons : {};
                
                const result = Object.keys(icons).length > 0 && Object.keys(original).length > 0;
                addTestResult('åœ–æ¨™é…ç½®æ¨¡çµ„', result, 
                    `åœ–æ¨™ä¸»é¡Œæ•¸é‡: ${Object.keys(icons).length}`);
                
                if (result) {
                    addTestResult('å¤¢å¹»è—å¤œåœ–æ¨™å­˜åœ¨', 
                        icons.dreamyBlue !== undefined, 
                        'æª¢æŸ¥æ–°ä¸»é¡Œçš„åœ–æ¨™é…ç½®');
                }
            } catch (error) {
                addTestResult('åœ–æ¨™é…ç½®æ¨¡çµ„', false, error.message);
            }
        }

        function testThemeCore() {
            try {
                const core = window.ThemeCore;
                const functions = ['getCurrentTheme', 'applyTheme', 'updateThemeButtons'];
                
                let allLoaded = true;
                functions.forEach(func => {
                    if (!core || typeof core[func] !== 'function') {
                        allLoaded = false;
                    }
                });
                
                addTestResult('æ ¸å¿ƒåŠŸèƒ½æ¨¡çµ„', allLoaded, 
                    `æª¢æŸ¥å‡½æ•¸: ${functions.join(', ')}`);
                
                if (allLoaded) {
                    const currentTheme = core.getCurrentTheme();
                    addTestResult('ç²å–ç•¶å‰ä¸»é¡Œ', true, `ç•¶å‰ä¸»é¡Œ: ${currentTheme}`);
                }
            } catch (error) {
                addTestResult('æ ¸å¿ƒåŠŸèƒ½æ¨¡çµ„', false, error.message);
            }
        }

        function testThemeUI() {
            try {
                const ui = window.ThemeUI;
                const functions = ['showThemeSelector', 'createThemeModal', 'renderThemeGrid'];
                
                let allLoaded = true;
                functions.forEach(func => {
                    if (!ui || typeof ui[func] !== 'function') {
                        allLoaded = false;
                    }
                });
                
                addTestResult('UIçµ„ä»¶æ¨¡çµ„', allLoaded, 
                    `æª¢æŸ¥å‡½æ•¸: ${functions.join(', ')}`);
            } catch (error) {
                addTestResult('UIçµ„ä»¶æ¨¡çµ„', false, error.message);
            }
        }

        function applyTestTheme() {
            try {
                if (window.ThemeCore) {
                    window.ThemeCore.applyTheme('dreamyBlue');
                    addTestResult('æ‡‰ç”¨æ¸¬è©¦ä¸»é¡Œ', true, 'å·²æ‡‰ç”¨å¤¢å¹»è—å¤œä¸»é¡Œ');
                    
                    // æª¢æŸ¥æ˜¯å¦æˆåŠŸæ‡‰ç”¨
                    setTimeout(() => {
                        const root = document.documentElement;
                        const currentTheme = root.getAttribute('data-theme');
                        addTestResult('ä¸»é¡Œæ‡‰ç”¨é©—è­‰', currentTheme === 'dreamyBlue', 
                            `ç•¶å‰data-theme: ${currentTheme}`);
                    }, 100);
                } else {
                    addTestResult('æ‡‰ç”¨æ¸¬è©¦ä¸»é¡Œ', false, 'ThemeCoreæœªè¼‰å…¥');
                }
            } catch (error) {
                addTestResult('æ‡‰ç”¨æ¸¬è©¦ä¸»é¡Œ', false, error.message);
            }
        }

        function showThemeSelector() {
            try {
                if (window.ThemeUI) {
                    window.ThemeUI.showThemeSelector();
                    addTestResult('é¡¯ç¤ºä¸»é¡Œé¸æ“‡å™¨', true, 'ä¸»é¡Œé¸æ“‡å™¨å·²é¡¯ç¤º');
                } else {
                    addTestResult('é¡¯ç¤ºä¸»é¡Œé¸æ“‡å™¨', false, 'ThemeUIæœªè¼‰å…¥');
                }
            } catch (error) {
                addTestResult('é¡¯ç¤ºä¸»é¡Œé¸æ“‡å™¨', false, error.message);
            }
        }

        // ç­‰å¾…æ¨¡çµ„è¼‰å…¥å®Œæˆå¾Œé€²è¡Œæª¢æŸ¥
        setTimeout(() => {
            checkModuleStatus();
            updateStatus('ä¸»é¡Œæ¨¡çµ„è¼‰å…¥å®Œæˆï¼Œå¯ä»¥é–‹å§‹æ¸¬è©¦', false);
        }, 2000);
    </script>
</body>
</html>
